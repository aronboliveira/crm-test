FROM node:20-alpine AS base

WORKDIR /app

COPY package*.json ./
COPY apps/web/package*.json ./apps/web/
COPY apps/api/package*.json ./apps/api/
COPY packages/contracts/package*.json ./packages/contracts/
COPY packages/foundations/package*.json ./packages/foundations/

RUN npm ci

FROM base AS development

WORKDIR /app

COPY . .

EXPOSE 5173

CMD ["npm", "run", "--workspace=apps/web", "dev", "--", "--host", "0.0.0.0"]
